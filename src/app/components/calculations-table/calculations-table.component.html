<mat-card class="card">
  <mat-card-header>
    <mat-card-title>Investment Growth Table</mat-card-title>
    <mat-card-subtitle>
      Calculations based on your investment plan.
    </mat-card-subtitle>
  </mat-card-header>
  <mat-card-content>
    <cdk-accordion class="accordion">
      <cdk-accordion-item
        #accordionItem="cdkAccordionItem"
        class="accordion-item"
        role="button"
        tabindex="0"
        [attr.id]="'accordion-header-' + -1"
        [attr.aria-expanded]="accordionItem.expanded"
        [attr.aria-controls]="'accordion-body-' + -1">
        <div class="accordion-item-header column-names" (click)="accordionItem.toggle()">
          <span class="accordion-item-column chevron-col align-start no-grow">
            <mat-icon
              aria-hidden="false"
              aria-label="Expand icon"
              [fontIcon]="'event'"
            ></mat-icon>
          </span>
          <span class="accordion-item-column align-start day-col">Day</span>
          <span class="accordion-item-column align-start date-col">Date</span>
          <span class="accordion-item-column align-end balance-col">Balance<br>(Locked Value)</span>
          <span class="accordion-item-column align-end yield-percent-col">Yield<br>(Daily %)</span>
          <span class="accordion-item-column align-end yield-today-col">Yield<br>Today</span>
          <span class="accordion-item-column align-end yield-avail-col">Yield<br>Available</span>
          <span class="accordion-item-column align-end action-col">Action</span>
          <span class="accordion-item-column align-end deposited-col">Deposited<br>Today</span>
          <span class="accordion-item-column align-end compounded-col">Compounded<br>Today</span>
          <span class="accordion-item-column align-end withdrawn-col">Withdrawn<br>Today</span>
          <span class="accordion-item-column align-end difference-col">Balance<br>Change</span>
          <span class="accordion-item-column align-end tot-deposit-col">Total<br>Deposited</span>
          <span class="accordion-item-column align-end tot-compound-col">Total<br>Compounded</span>
          <span class="accordion-item-column align-end tot-withdraw-col">Total<br>Withdrawn</span>
          <span class="accordion-item-column align-end tot-claimed-col">Total<br>Claimed</span>
        </div>
      </cdk-accordion-item>
      <cdk-accordion-item
        *ngFor="let item of dailyData; let index = index; trackBy: trackByDate"
        #accordionItem="cdkAccordionItem"
        class="accordion-item"
        role="button"
        tabindex="0"
        [attr.id]="'accordion-header-' + index"
        [attr.aria-expanded]="accordionItem.expanded"
        [attr.aria-controls]="'accordion-body-' + index">
        <div class="accordion-item-header" (click)="accordionItem.toggle()">
          <span class="accordion-item-column chevron-col align-start no-grow">
              <mat-icon
                aria-hidden="false"
                aria-label="Expand icon"
                [fontIcon]="accordionItem.expanded ? 'expand_more' : 'chevron_right' "
              ></mat-icon>
          </span>
          <span class="accordion-item-column align-start day-col">{{ index }}</span>
          <span class="accordion-item-column align-start date-col">{{ item.date }}</span>
          <span class="accordion-item-column align-end balance-col bold">{{ item.balance | currency }}</span>
          <span class="accordion-item-column align-end yield-percent-col">{{ item.rewardsPercent }}%</span>
          <span
            class="accordion-item-column align-end yield-today-col">{{ item.rewardsUnlockedToday | currency }}</span>
          <span class="accordion-item-column align-end yield-avail-col">{{ item.rewardsAvailable | currency }}</span>
          <span class="accordion-item-column align-end action-col">{{ item.actionMade }}</span>
          <span class="accordion-item-column align-end deposited-col">{{ item.depositedToday | currency }}</span>
          <span class="accordion-item-column align-end compounded-col">{{ item.compoundedToday | currency }}</span>
          <span class="accordion-item-column align-end withdrawn-col">{{ item.withdrawnToday | currency }}</span>
          <span class="accordion-item-column align-end difference-col bold">
            {{ item.balanceDifference >= 0 ? "+" : null }}{{ item.balanceDifference | currency }}
          </span>
          <span class="accordion-item-column align-end tot-deposit-col">{{ item.totalDeposited | currency }}</span>
          <span class="accordion-item-column align-end tot-compound-col">{{ item.totalCompounded | currency }}</span>
          <span class="accordion-item-column align-end tot-withdraw-col">{{ item.totalWithdrawn | currency }}</span>
          <span class="accordion-item-column align-end tot-claimed-col">{{ item.totalPayouts | currency }}</span>
        </div>
        <div
          class="accordion-item-body"
          role="region"
          [style.display]="accordionItem.expanded ? '' : 'none'"
          [attr.id]="'accordion-body-' + index"
          [attr.aria-labelledby]="'accordion-header-' + index"
        >
          <ng-container *ngIf="accordionItem.expanded">
            <div class="text-summary">
              <h3>Summary:</h3>
              <p>
                On <strong>{{ item.date }}</strong>, Day <strong>{{ index }}</strong>, you started with a balance of
                <strong>{{ item.balance | currency }}</strong>.
                Your yield rate for the day was <strong>{{ item.rewardsPercent }}%</strong>, which resulted in
                yield
                of <strong>{{ item.rewardsUnlockedToday | currency }}</strong> for the day.
                This brought your available yield to <strong>{{ item.rewardsAvailable | currency}}</strong>.
              </p>
              <p>
                On this day, you
                <strong>{{ item.actionMade === "Hold" ? "held your balance" : item.actionMade + " " + ((item.depositedToday || item.withdrawnToday) | currency)}}</strong>.
                This action resulted in a balance change of
                <strong>{{ item.balanceDifference >= 0 ? "+" : "" }}{{ item.balanceDifference | currency}}</strong>,
                bringing your balance to <strong>{{ item.newBalance | currency }}</strong> at the end of the day.
              </p>
              <p>
                Cumulatively, you have deposited <strong>{{ item.totalDeposited | currency }}</strong>, withdrawn
                <strong>{{ item.totalWithdrawn | currency }}</strong>, and compounded
                <strong>{{ item.totalCompounded | currency }}</strong>
                till this date.
                Your realized profit stands at <strong>{{ item.realizedProfit | currency }}</strong>
                (<strong>{{ item.realizedProfitPercent }}%</strong>),
                and your unrealized profit is <strong>{{ item.unrealizedProfit | currency }}</strong>
                (<strong>{{ item.unrealizedProfitPercent }}%</strong>).
              </p>
            </div>

            <div class="rewards-info">
              <h3>Rewards Information:</h3>
              <table>
                <tr>
                  <td>Daily yield rate:</td>
                  <td>{{item.rewardsPercent}}%</td>
                </tr>
                <tr>
                  <td>Yield unlocked today:</td>
                  <td>{{item.rewardsUnlockedToday | currency}}</td>
                </tr>
                <tr>
                  <td>Accumulated yield available:</td>
                  <td>{{item.rewardsAvailable | currency}}</td>
                </tr>
                <tr>
                  <td>Total compounds:</td>
                  <td>{{item.totalCompounded | currency}}</td>
                </tr>
                <tr>
                  <td>Total claimed:</td>
                  <td>{{item.totalPayouts | currency}}</td>
                </tr>
              </table>
            </div>

            <div class="balance-breakdown">
              <h3>Balance Breakdown:</h3>
              <table>
                <tr>
                  <td>Balance at start of day:</td>
                  <td>{{item.balance | currency}}</td>
                </tr>
                <tr>
                  <td>Action you made:</td>
                  <td>{{item.actionMade === "Hold" ? "Held balance" : item.actionMade + "ed " + ((item.depositedToday || item.withdrawnToday) | currency)}}</td>
                </tr>
                <tr>
                  <td>Balance at end of day:</td>
                  <td>{{item.newBalance | currency}}</td>
                </tr>
                <tr>
                  <td>Balance change today:</td>
                  <td>{{item.balanceDifference | currency}}</td>
                </tr>
                <tr>
                  <td>Claims until max payout:</td>
                  <td>{{2500000 - item.totalPayouts | currency}}</td>
                </tr>
              </table>
            </div>

            <div class="return-on-investment">
              <h3>Return on Investment:</h3>
              <table>
                <tr>
                  <td>Total Deposited:</td>
                  <td>{{item.totalDeposited | currency}}</td>
                </tr>
                <tr>
                  <td>Total Withdrawn:</td>
                  <td>{{item.totalWithdrawn | currency}}</td>
                </tr>
                <tr>
                  <td>Realized Profit:</td>
                  <td>{{item.realizedProfit | currency}}</td>
                </tr>
                <tr>
                  <td>Realized Profit Percent:</td>
                  <td>{{item.realizedProfitPercent}}%</td>
                </tr>
                <tr>
                  <td>Unrealized Profit:</td>
                  <td>{{item.unrealizedProfit | currency}}</td>
                </tr>
                <tr>
                  <td>Unrealized Profit Percent:</td>
                  <td>{{item.unrealizedProfitPercent}}%</td>
                </tr>
              </table>
            </div>
          </ng-container>
        </div>
      </cdk-accordion-item>
    </cdk-accordion>
  </mat-card-content>
</mat-card>
